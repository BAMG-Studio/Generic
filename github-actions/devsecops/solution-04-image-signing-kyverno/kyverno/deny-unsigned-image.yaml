apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata:
  name: require-image-signature
spec:
  validationFailureAction: enforce
  rules:
  - name: check-image-signature
    match:
      resources:
        kinds: ["Pod"]
    validate:
      message: "Image must be cosign-signed and have sbom-validated=true annotation"
      pattern:
        spec:
          containers:
          - image: "*"
            # This is a conceptual pattern; use an admission webhook to verify signature
            # In practice Kyverno will call an external webhook or you can use OPA to verify
            # ...existing code...
